INFO:root:
 NEW RUN STARTING: 2022.07.06 09:05
INFO:root:Accepted sys args on launch: source_fpath: C:\Coding\Ebay\Working\Backups\Amazon warehouse csv\warehouse2.csv; sales_channel: Amazon Warehouse. Whole sys.argv: ['C:\\Coding\\Ebay\\Custom Label Sorting\\Helper Files\\main_inventory.exe', 'C:\\Coding\\Ebay\\Working\\Backups\\Amazon warehouse csv\\warehouse2.csv', 'Amazon Warehouse']
INFO:root:Database has been created at C:\Coding\Ebay\Custom Label Sorting\Helper Files\inventory.db
INFO:root:New database backup inventory_b4lrun.db created on: 2022-07-06 09:05 location: C:\Coding\Ebay\Custom Label Sorting\Helper Files\inventory_b4lrun.db
INFO:root:Returning 132/132 new/loaded orders for further processing
INFO:root:Loaded file contains: 132. Further processing: 132 orders
INFO:root:Current sku mapping dict has 1354 entries
INFO:root:Orders inside valid: 132; invalid: 0
INFO:root:Backup created at: C:\Coding\Ebay\Custom Label Sorting\Helper Files\Inventory Reduction b4lastrun.xlsx, before touching C:\Coding\Ebay\Custom Label Sorting\Inventory Reduction.xlsx
INFO:root:Before updating workbook has 275 distinct sku codes / data rows excl. headers
INFO:root:Writing updated values done. Saving, closing...
INFO:root:Helper file Inventory Reduction.xlsx successfully updated, opening....
INFO:root:Backup created at: C:\Coding\Ebay\Custom Label Sorting\Helper Files\src files\Amazon Warehouse 22-07-06 09-05.csv
INFO:root:New database backup inventory_lrun.db created on: 2022-07-06 09:05 location: C:\Coding\Ebay\Custom Label Sorting\Helper Files\inventory_lrun.db
INFO:root:Total of 132 new orders have been added to database, after exports were completed, closing connection to DB
INFO:root:
RUN ENDED: 2022.07.06 09:05


INFO:root:
 NEW RUN STARTING: 2022.07.06 09:07
INFO:root:Accepted sys args on launch: source_fpath: C:\Coding\Ebay\Working\Backups\Amazon exports\EU 2022.01.25.txt; sales_channel: Amazon. Whole sys.argv: ['C:\\Coding\\Ebay\\Custom Label Sorting\\Helper Files\\main_inventory.exe', 'C:\\Coding\\Ebay\\Working\\Backups\\Amazon exports\\EU 2022.01.25.txt', 'Amazon']
INFO:root:New database backup inventory_b4lrun.db created on: 2022-07-06 09:07 location: C:\Coding\Ebay\Custom Label Sorting\Helper Files\inventory_b4lrun.db
INFO:root:Returning 654/654 new/loaded orders for further processing
INFO:root:Loaded file contains: 654. Further processing: 654 orders
INFO:root:Current sku mapping dict has 1354 entries
INFO:root:Orders inside valid: 654; invalid: 0
INFO:root:Backup created at: C:\Coding\Ebay\Custom Label Sorting\Helper Files\Inventory Reduction b4lastrun.xlsx, before touching C:\Coding\Ebay\Custom Label Sorting\Inventory Reduction.xlsx
INFO:root:Before updating workbook has 275 distinct sku codes / data rows excl. headers
INFO:root:Writing updated values done. Saving, closing...
CRITICAL:root:Workbook C:\Coding\Ebay\Custom Label Sorting\Inventory Reduction.xlsx already open. Err: [Errno 13] Permission denied: 'C:\\Coding\\Ebay\\Custom Label Sorting\\Inventory Reduction.xlsx'
ERROR:root:Unexpected error UPDATING helper file. Closing database connection, alerting VBA, exiting... Last error: Transition from HelperFileUpdate.updateworkbook error handling to ParseOrders.export_update_inventory_helper_file error handling
Traceback (most recent call last):
  File "helper_file.py", line 101, in update_workbook
  File "openpyxl\workbook\workbook.py", line 392, in save
  File "openpyxl\writer\excel.py", line 291, in save_workbook
  File "zipfile.py", line 1204, in __init__
PermissionError: [Errno 13] Permission denied: 'C:\\Coding\\Ebay\\Custom Label Sorting\\Inventory Reduction.xlsx'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "parse_orders.py", line 203, in update_inventory_file
  File "helper_file.py", line 106, in update_workbook
Exception: Transition from HelperFileUpdate.updateworkbook error handling to ParseOrders.export_update_inventory_helper_file error handling
INFO:root:
 NEW RUN STARTING: 2022.07.06 09:07
INFO:root:Accepted sys args on launch: source_fpath: C:\Coding\Ebay\Working\Backups\Etsy\EtsySoldOrders2022-4.csv; sales_channel: Etsy. Whole sys.argv: ['C:\\Coding\\Ebay\\Custom Label Sorting\\Helper Files\\main_inventory.exe', 'C:\\Coding\\Ebay\\Working\\Backups\\Etsy\\EtsySoldOrders2022-4.csv', 'Etsy']
INFO:root:New database backup inventory_b4lrun.db created on: 2022-07-06 09:07 location: C:\Coding\Ebay\Custom Label Sorting\Helper Files\inventory_b4lrun.db
INFO:root:Returning 321/321 new/loaded orders for further processing
INFO:root:Loaded file contains: 321. Further processing: 321 orders
INFO:root:Etsy order q-ty and skus may yield various combinations. Qty: 3, skus: ['1 vnt. 1038249', '1 vnt. 10023018']. Ordr being added to invalid list
INFO:root:Etsy order q-ty and skus may yield various combinations. Qty: 3, skus: ['1 vnt. T1141', '1 vnt. 1040830', '1 vnt. 1034630', '1 vnt. T1151']. Ordr being added to invalid list
INFO:root:Orders inside valid: 319; invalid: 2
INFO:root:Invalid orders exported at C:\Coding\Ebay\Custom Label Sorting\Etsy invalid_orders 2022.07.06 09.07.txt and opened.
INFO:root:Backup created at: C:\Coding\Ebay\Custom Label Sorting\Helper Files\Inventory Reduction b4lastrun.xlsx, before touching C:\Coding\Ebay\Custom Label Sorting\Inventory Reduction.xlsx
INFO:root:Before updating workbook has 275 distinct sku codes / data rows excl. headers
INFO:root:Writing updated values done. Saving, closing...
INFO:root:Helper file Inventory Reduction.xlsx successfully updated, opening....
INFO:root:Backup created at: C:\Coding\Ebay\Custom Label Sorting\Helper Files\src files\Etsy 22-07-06 09-07.csv
INFO:root:New database backup inventory_lrun.db created on: 2022-07-06 09:07 location: C:\Coding\Ebay\Custom Label Sorting\Helper Files\inventory_lrun.db
INFO:root:Total of 321 new orders have been added to database, after exports were completed, closing connection to DB
INFO:root:
RUN ENDED: 2022.07.06 09:07


INFO:root:
 NEW RUN STARTING: 2022.07.06 09:08
INFO:root:Accepted sys args on launch: source_fpath: C:\Coding\Ebay\Working\Backups\Amazon exports\EU 2022.01.25.txt; sales_channel: Amazon. Whole sys.argv: ['C:\\Coding\\Ebay\\Custom Label Sorting\\Helper Files\\main_inventory.exe', 'C:\\Coding\\Ebay\\Working\\Backups\\Amazon exports\\EU 2022.01.25.txt', 'Amazon']
INFO:root:New database backup inventory_b4lrun.db created on: 2022-07-06 09:08 location: C:\Coding\Ebay\Custom Label Sorting\Helper Files\inventory_b4lrun.db
INFO:root:Returning 654/654 new/loaded orders for further processing
INFO:root:Loaded file contains: 654. Further processing: 654 orders
INFO:root:Current sku mapping dict has 1354 entries
INFO:root:Orders inside valid: 654; invalid: 0
INFO:root:Backup created at: C:\Coding\Ebay\Custom Label Sorting\Helper Files\Inventory Reduction b4lastrun.xlsx, before touching C:\Coding\Ebay\Custom Label Sorting\Inventory Reduction.xlsx
INFO:root:Before updating workbook has 0 distinct sku codes / data rows excl. headers
INFO:root:Writing updated values done. Saving, closing...
INFO:root:Helper file Inventory Reduction.xlsx successfully updated, opening....
INFO:root:Backup created at: C:\Coding\Ebay\Custom Label Sorting\Helper Files\src files\Amazon 22-07-06 09-08.txt
INFO:root:New database backup inventory_lrun.db created on: 2022-07-06 09:08 location: C:\Coding\Ebay\Custom Label Sorting\Helper Files\inventory_lrun.db
INFO:root:Total of 654 new orders have been added to database, after exports were completed, closing connection to DB
INFO:root:
RUN ENDED: 2022.07.06 09:08


